"0","# Permutation test for Conversion Rates"
"0","set.seed(123)"
"0","R <- 10000     "
"0","obs_var_ratio <- var(conv_new) / var(conv_old)"
"0",""
"0","# Pool the data"
"0","combined <- c(conv_new, conv_old) "
"0","n_total <- length(combined)"
"0","n_new <- length(conv_new) "
"0","n_old <- length(conv_old) "
"0",""
"0","# Generate the permutation distribution (Logic inside remains the same)"
"0","perm_ratios <- replicate(R, {"
"0","  idx <- sample(n_total)"
"0","  perm_new <- combined[idx[1:n_new]]"
"0","  perm_old <- combined[idx[(n_new + 1):n_total]]"
"0","  var(perm_new) / var(perm_old)"
"0","})"
"0",""
"0","# Calculate p-value for H1: ratio > 1"
"0","p_val <- mean(perm_ratios > obs_var_ratio)"
"0",""
"0","tibble("
"0","  observed_var_ratio = obs_var_ratio,"
"0","  p_value = p_val"
"0",")"
