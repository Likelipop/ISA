"0","# Permutation test (H1: μ_new > μ_old, α=0.05)"
"0","set.seed(123)  "
"0","R <- 10000     "
"0",""
"0","# Pool the data"
"0","combined <- c(time_new, time_old)"
"0","n_total <- length(combined)"
"0","n_new <- length(time_new)"
"0","n_old <- length(time_old)"
"0",""
"0","# Calculate the observed statistic"
"0","diff_obs <- mean(time_new) - mean(time_old)"
"0",""
"0","# Generate the permutation distribution"
"0","perm_diff <- replicate(R, {"
"0","  idx <- sample(n_total)"
"0","  new_idx <- idx[1:n_new]"
"0","  old_idx <- idx[(n_new + 1):n_total]"
"0","  mean(combined[new_idx]) - mean(combined[old_idx])"
"0","})"
"0",""
"0","# Calculate p-value for the one-sided hypothesis (new > old)"
"0","p_val <- mean(perm_diff > diff_obs)"
"0",""
"0","# Results"
"0","tibble("
"0","  observed_diff = diff_obs,"
"0","  p_value = p_val"
"0",")"
