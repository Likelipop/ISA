<<<<<<< HEAD
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((conv_sm^2)/n_m + (conv_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
m_stats <- data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
group_by(time) |>
summarise(across(
roi,
list(
mean = mean,
median = median,
sd = sd,
min = min,
max = max
),
na.rm = TRUE,
.names = "{.fn}"
))
data_b <- data_b|>
mutate(roi = value/cost)
m_stats <- data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
group_by(time) |>
summarise(across(
roi,
list(
mean = mean,
median = median,
sd = sd,
min = min,
max = max
),
na.rm = TRUE,
.names = "{.fn}"
))
m_stats
data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
ggplot(aes(x = time, y = roi, fill = time)) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.15, color = "black", alpha = 0.8) +
scale_fill_manual(values = c("pre" = "#8C6BB1", "post" = "#9E9AC8")) +
labs(
title = "Comparison of conv Distributions (Pre vs Post)",
x = "",
y = "conv"
) +
theme_minimal(base_size = 14)
data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
mutate(roi_log = log1p(roi)) |>
ggplot(aes(x = time, y = roi_log, fill = time)) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.15, color = "black", alpha = 0.8) +
scale_fill_manual(values = c("pre" = "#8C6BB1", "post" = "#9E9AC8")) +
labs(
title = "Violin Plot using log1p(conv)",
x = "",
y = "log1p(conv)"
) +
theme_minimal(base_size = 14)
set.seed(42)
roi_m <- data_b |>
filter(platform == "m") |>
select(roi) |>
pull()
roi_d <- data_b |>
filter(platform == "d") |>
select(roi) |>
pull()
observed_diff <- abs(mean(roi_m,na.rm = TRUE) - mean(roi_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
set.seed(42)
roi_m <- data_b |>
filter(platform == "m") |>
select(roi) |>
pull()
roi_d <- data_b |>
filter(platform == "d") |>
select(roi) |>
pull()
observed_diff <- abs(mean(roi_m,na.rm = TRUE) - mean(roi_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
p_value
set.seed(42)
roi_m <- data_b |>
filter(platform == "m") |>
select(roi) |>
pull()
roi_d <- data_b |>
filter(platform == "d") |>
select(roi) |>
pull()
observed_diff <- abs(mean(roi_m,na.rm = TRUE) - mean(roi_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
p_value
diffs_simulated
n_m
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d ))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sqrt((sd(sample_m)**2)/n_m + (sd(sample_d)**2)/n_d ))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sqrt((sd(sample_m)*sd(sample_m))/n_m + (sd(sample_d)*sd(sample_d))/n_d ))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sd(sample_m))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sample_m)
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sample_m)
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
roi_m
roi_m_til
mean(roi_m)
clas(roi_m)
class(roi_m)
mean(roi_m)
mean(roi_m,na.rm = TRUE)
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sample_m)
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
diffs_simulated
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 1
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
print(sample_m)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m,na.rm = TRUE)
roi_sd <- sd(roi_d,na.rm = TRUE)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m,na.rm = TRUE) - mean(sample_d,na.rm = TRUE))/sqrt((sd(sample_m,na.rm = TRUE)^2)/n_m + (sd(sample_d,na.rm = TRUE)^2)/n_d )
}
cat("Done.\n\n")
diffs_simulated
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
set.seed(42)
conv_m <- data_b |>
filter(platform == "m") |>
select(conv) |>
pull()
conv_d <- data_b |>
filter(platform == "d") |>
select(conv) |>
pull()
observed_diff <- abs(mean(conv_m,na.rm = TRUE) - mean(conv_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
n_m <- length(conv_m)
n_d <- length(conv_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
conv_m_til <- conv_m - mean(conv_m,na.rm = TRUE)
conv_d_til <- conv_d -mean(conv_d,na.rm = TRUE)
conv_sm <- sd(conv_m,na.rm = TRUE)
conv_sd <- sd(conv_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(conv_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(conv_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m,na.rm = TRUE) - mean(sample_d,na.rm = TRUE))/sqrt((sd(sample_m,na.rm = TRUE)^2)/n_m + (sd(sample_d,na.rm = TRUE)^2)/n_d )
}
cat("Done.\n\n")
abs(T_obs)
max(abs(diffs_simulated))
T_obs <- observed_diff/sqrt((conv_sm^2)/n_m + (conv_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
abs(T_obs)
max(abs(diffs_simulated))
T_obs <- observed_diff/sqrt((conv_sm^2)/n_m + (conv_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
cpc_m_zero <- data_b |>
filter(time == "post", cpc == 0, platform == "m")
cpc_m <- data_b |>
filter(time == "post", platform == "m")
cpc_d_zero <- data_b |>
filter(time == "post", cpc == 0, platform == "d")
cpc_d <- data_b |>
filter(time == "post", platform == "d")
cpc_m_zero
prop.test(
x = c(nrow(cpc_m_zero), nrow(cpc_d_zero)),
n = c(nrow(cpc_m), nrow(cpc_d)),
correct = FALSE
)
=======
var_d_thuc_te <- var(D)
# Tính tổng phương sai (nếu giả sử độc lập)
var_independent <- var_x + var_y
# Tính thành phần giảm trừ (Reduction term)
reduction_term <- 2 * cov_xy
# In kết quả so sánh
cat("\n--- SO SÁNH PHƯƠNG SAI ---\n")
cat("Phương sai của Vani Var(X):", var_x, "\n")
cat("Phương sai của Chocolate Var(Y):", var_y, "\n")
cat("Tổng phương sai (nếu độc lập):", var_independent, "\n")
cat("Thành phần giảm trừ (2*Cov):", reduction_term, "\n")
cat("Phương sai của khác biệt Var(D) [Thực tế]:", var_d_thuc_te, "\n")
# Kiểm chứng công thức toán học
cat("Kiểm chứng công thức (Var_Indep - 2Cov):", var_independent - reduction_term, "\n")
# ---------------------------------------------------------
# PHẦN 4: HỆ QUẢ LÊN KIỂM ĐỊNH T (T-TEST IMPLICATION)
# So sánh p-value khi dùng sai (độc lập) và dùng đúng (ghép cặp)
# ---------------------------------------------------------
test_wrong <- t.test(Y, X, paired = FALSE)
test_right <- t.test(Y, X, paired = TRUE)
cat("\n--- SO SÁNH KẾT QUẢ KIỂM ĐỊNH ---\n")
cat("P-value (Giả định độc lập):", test_wrong$p.value, "\n")
cat("P-value (Giả định ghép cặp):", test_right$p.value, "\n")
# ---------------------------------------------------------
# PHẦN 1: CHUẨN BỊ DỮ LIỆU
# ---------------------------------------------------------
X <- data_ice_cream$VanillaCalories      # Biến ngẫu nhiên X
Y <- data_ice_cream$ChocolateCalories    # Biến ngẫu nhiên Y
D <- Y - X                               # Biến ngẫu nhiên D (Difference)
# ---------------------------------------------------------
# PHẦN 2: KIỂM CHỨNG HIỆP PHƯƠNG SAI (COVARIANCE)
# Lý thuyết: Nếu ghép cặp đúng, Cov(X,Y) > 0.
# ---------------------------------------------------------
# Tính hệ số tương quan Pearson (r)
cor_xy <- cor(X, Y)
# Kỳ vọng: r rất gần 1 (vì cùng một hãng sản xuất)
# Tính Hiệp phương sai (Covariance)
cov_xy <- cov(X, Y)
# In kết quả
cat("\n--- r VÀ cov ---\n")
cat("Hệ số tương quan Pearson (r):", cor_xy, "\n")
cat("Phương sai của X và Y:", cov_xy, "\n")
# ---------------------------------------------------------
# PHẦN 3: CHỨNG MINH SỰ GIẢM PHƯƠNG SAI (VARIANCE REDUCTION)
# Lý thuyết: Var(D) = Var(X) + Var(Y) - 2*Cov(X,Y)
# ---------------------------------------------------------
var_x <- var(X)
var_y <- var(Y)
var_d_thuc_te <- var(D)
# Tính tổng phương sai (nếu giả sử độc lập)
var_independent <- var_x + var_y
# Tính thành phần giảm trừ (Reduction term)
reduction_term <- 2 * cov_xy
# In kết quả so sánh
cat("\n--- SO SÁNH PHƯƠNG SAI ---\n")
cat("Phương sai của Vani Var(X):", var_x, "\n")
cat("Phương sai của Chocolate Var(Y):", var_y, "\n")
cat("Tổng phương sai (nếu độc lập):", var_independent, "\n")
cat("Thành phần giảm trừ (2*Cov):", reduction_term, "\n")
cat("Phương sai của khác biệt Var(D) [Thực tế]:", var_d_thuc_te, "\n")
# Kiểm chứng công thức toán học
cat("Kiểm chứng công thức (Var_Indep - 2Cov):", var_independent - reduction_term, "\n")
# ---------------------------------------------------------
# PHẦN 4: HỆ QUẢ LÊN KIỂM ĐỊNH T (T-TEST IMPLICATION)
# So sánh p-value khi dùng sai (độc lập) và dùng đúng (ghép cặp)
# ---------------------------------------------------------
test_wrong <- t.test(Y, X, paired = FALSE)
test_right <- t.test(Y, X, paired = TRUE)
cat("\n--- SO SÁNH KẾT QUẢ KIỂM ĐỊNH ---\n")
cat("P-value (Giả định độc lập):", test_wrong$p.value, "\n")
cat("P-value (Giả định ghép cặp):", test_right$p.value, "\n")
# ---------------------------------------------------------
# PHẦN 1: CHUẨN BỊ DỮ LIỆU
# ---------------------------------------------------------
X <- data_ice_cream$VanillaCalories      # Biến ngẫu nhiên X
Y <- data_ice_cream$ChocolateCalories    # Biến ngẫu nhiên Y
D <- Y - X                               # Biến ngẫu nhiên D (Difference)
# ---------------------------------------------------------
# PHẦN 2: KIỂM CHỨNG HIỆP PHƯƠNG SAI (COVARIANCE)
# Lý thuyết: Nếu ghép cặp đúng, Cov(X,Y) > 0.
# ---------------------------------------------------------
# Tính hệ số tương quan Pearson (r)
cor_xy <- cor(X, Y)
# Kỳ vọng: r rất gần 1 (vì cùng một hãng sản xuất)
# Tính Hiệp phương sai (Covariance)
cov_xy <- cov(X, Y)
# In kết quả
cat("\n--- r VÀ cov ---\n")
cat("Hệ số tương quan Pearson (r):", cor_xy, "\n")
cat("Phương sai của X và Y:", cov_xy, "\n")
# ---------------------------------------------------------
# PHẦN 3: CHỨNG MINH SỰ GIẢM PHƯƠNG SAI (VARIANCE REDUCTION)
# Lý thuyết: Var(D) = Var(X) + Var(Y) - 2*Cov(X,Y)
# ---------------------------------------------------------
var_x <- var(X)
var_y <- var(Y)
var_d_thuc_te <- var(D)
# Tính tổng phương sai (nếu giả sử độc lập)
var_independent <- var_x + var_y
# Tính thành phần giảm trừ (Reduction term)
reduction_term <- 2 * cov_xy
# In kết quả so sánh
cat("\n--- SO SÁNH PHƯƠNG SAI ---\n")
cat("Phương sai của Vani Var(X):", var_x, "\n")
cat("Phương sai của Chocolate Var(Y):", var_y, "\n")
cat("Tổng phương sai (nếu độc lập):", var_independent, "\n")
cat("Thành phần giảm trừ (2*Cov):", reduction_term, "\n")
cat("Phương sai của khác biệt Var(D) [Thực tế]:", var_d_thuc_te, "\n")
# Kiểm chứng công thức toán học
cat("Kiểm chứng công thức (Var_Indep - 2Cov):", var_independent - reduction_term, "\n")
# ---------------------------------------------------------
# PHẦN 4: HỆ QUẢ LÊN KIỂM ĐỊNH T (T-TEST IMPLICATION)
# So sánh p-value khi dùng sai (độc lập) và dùng đúng (ghép cặp)
# ---------------------------------------------------------
test_wrong <- t.test(Y, X, paired = FALSE)
test_right <- t.test(Y, X, paired = TRUE)
cat("\n--- SO SÁNH KẾT QUẢ KIỂM ĐỊNH ---\n")
cat("P-value (Giả định độc lập):", test_wrong$p.value, "\n")
cat("P-value (Giả định ghép cặp):", test_right$p.value, "\n")
calories_data <- data_ice_cream[, c("VanillaCalories", "ChocolateCalories")]
summary(calories_data)
sd_vanilla <- sd(data_ice_cream$VanillaCalories)
sd_chocolate <- sd(data_ice_cream$ChocolateCalories)
sd_vanilla <- sd(data_ice_cream$VanillaCalories)
sd_chocolate <- sd(data_ice_cream$ChocolateCalories)
sd_vanilla
sd_chocolate
sd_vanilla <- sd(data_ice_cream$VanillaCalories)
sd_chocolate <- sd(data_ice_cream$ChocolateCalories)
sd_vanilla
sd_chocolate
stats_table <- data.frame(
Variable = c("VanillaCalories", "ChocolateCalories"),
N = c(length(data_ice_cream$VanillaCalories), length(data_ice_cream$ChocolateCalories)),
Mean = c(mean(data_ice_cream$VanillaCalories), mean(data_ice_cream$ChocolateCalories)),
Median = c(median(data_ice_cream$VanillaCalories), median(data_ice_cream$ChocolateCalories)),
SD = c(sd_vanilla, sd_chocolate),
Min = c(min(data_ice_cream$VanillaCalories), min(data_ice_cream$ChocolateCalories)),
Max = c(max(data_ice_cream$VanillaCalories), max(data_ice_cream$ChocolateCalories))
)
stats_table <- data.frame(
Variable = c("VanillaCalories", "ChocolateCalories"),
N = c(length(data_ice_cream$VanillaCalories), length(data_ice_cream$ChocolateCalories)),
Mean = c(mean(data_ice_cream$VanillaCalories), mean(data_ice_cream$ChocolateCalories)),
Median = c(median(data_ice_cream$VanillaCalories), median(data_ice_cream$ChocolateCalories)),
SD = c(sd_vanilla, sd_chocolate),
Min = c(min(data_ice_cream$VanillaCalories), min(data_ice_cream$ChocolateCalories)),
Max = c(max(data_ice_cream$VanillaCalories), max(data_ice_cream$ChocolateCalories))
)
stats_table
stats_table <- data.frame(
Variable = c("VanillaCalories", "ChocolateCalories"),
N = c(length(data_ice_cream$VanillaCalories), length(data_ice_cream$ChocolateCalories)),
Mean = c(mean(data_ice_cream$VanillaCalories), mean(data_ice_cream$ChocolateCalories)),
Median = c(median(data_ice_cream$VanillaCalories), median(data_ice_cream$ChocolateCalories)),
SD = c(sd_vanilla, sd_chocolate),
Min = c(min(data_ice_cream$VanillaCalories), min(data_ice_cream$ChocolateCalories)),
Max = c(max(data_ice_cream$VanillaCalories), max(data_ice_cream$ChocolateCalories)),
Min = c(min(data_ice_cream$VanillaCalories), min(data_ice_cream$ChocolateCalories)),
Max = c(max(data_ice_cream$VanillaCalories), max(data_ice_cream$ChocolateCalories))
)
stats_table
calories_data <- data_ice_cream[, c("VanillaCalories", "ChocolateCalories")]
summary(calories_data)
result_table_long <- data_ice_cream |>
filter(!is.na(VanillaCalories)) |>
summarise(across(.cols = VanillaCalories, .fns = list(
mean = ~mean(., na.rm = TRUE),
median = ~median(., na.rm = TRUE),
sd = ~sd(., na.rm = TRUE),
min = ~min(., na.rm = TRUE),
Q1 = ~quantile(., probs = 0.25, na.rm = TRUE),
Q3 = ~quantile(., probs = 0.75, na.rm = TRUE),
max = ~max(., na.rm = TRUE)
), .names = "{.col}.{.fn}")) |> .
calories_data <- data_ice_cream[, c("VanillaCalories", "ChocolateCalories")]
summary(calories_data)
result_table_long <- data_ice_cream |>
filter(!is.na(VanillaCalories)) |>
summarise(across(.cols = VanillaCalories, .fns = list(
mean = ~mean(., na.rm = TRUE),
median = ~median(., na.rm = TRUE),
sd = ~sd(., na.rm = TRUE),
min = ~min(., na.rm = TRUE),
Q1 = ~quantile(., probs = 0.25, na.rm = TRUE),
Q3 = ~quantile(., probs = 0.75, na.rm = TRUE),
max = ~max(., na.rm = TRUE)
), .names = "{.col}.{.fn}")) |> .
calories_data <- data_ice_cream[, c("VanillaCalories", "ChocolateCalories")]
summary(calories_data)
V <- data_ice_cream$VanillaCalories
C <- data_ice_cream$ChocolateCalories
# Tính toán các chỉ số thống kê
n_obs <- length(V)
sd_v <- sd(V)
sd_c <- sd(C)
# Tính Sai số chuẩn của Trung bình (SEM)
sem_v <- sd_v / sqrt(n_obs)
sem_c <- sd_c / sqrt(n_obs)
# Tính các phân vị (Q1, Median, Q3)
q_v <- quantile(V, probs = c(0.25, 0.50, 0.75))
q_c <- quantile(C, probs = c(0.25, 0.50, 0.75))
stats_table <- data.frame(
Variable = c("VanillaCalories", "ChocolateCalories"),
N = n_obs,
Mean = c(mean(V), mean(C)),
SD = c(sd_v, sd_c),
SEM = c(sem_v, sem_c),
Median = c(q_v[2], q_c[2]),
Q1 = c(q_v[1], q_c[1]),
Q3 = c(q_v[3], q_c[3]),
Min = c(min(V), min(C)),
Max = c(max(V), max(C))
)
stats_table
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Lọc và mô tả dữ liệu
data_enviroment |>
filter(!is.na(Chlorine)) |>
summarize(across(.cols = Chlorine, .fns = list(
mean = ~mean(., na.rm = TRUE),
median = ~median(., na.rm = TRUE),
sd = ~sd(., na.rm = TRUE),
min = ~min(., na.rm = TRUE),
Q1 = ~quantile(., probs = 0.25, na.rm = TRUE),
Q3 = ~quantile(., probs = 0.75, na.rm = TRUE),
max = ~max(., na.rm = TRUE)
), .names = "{.col}.{.fn}")) |>
pivot_longer(cols = everything(),
names_to = "variable",
values_to = "value")
V <- data_ice_cream$VanillaCalories
C <- data_ice_cream$ChocolateCalories
# Tính toán các chỉ số thống kê
n_obs <- length(V)
sd_v <- sd(V)
sd_c <- sd(C)
# Tính Sai số chuẩn của Trung bình (SEM)
sem_v <- sd_v / sqrt(n_obs)
sem_c <- sd_c / sqrt(n_obs)
# Tính các phân vị (Q1, Median, Q3)
q_v <- quantile(V, probs = c(0.25, 0.50, 0.75))
q_c <- quantile(C, probs = c(0.25, 0.50, 0.75))
stats_table <- data.frame(
Variable = c("VanillaCalories", "ChocolateCalories"),
N = n_obs,
Mean = c(mean(V), mean(C)),
SD = c(sd_v, sd_c),
SEM = c(sem_v, sem_c),
Median = c(q_v[2], q_c[2]),
Q1 = c(q_v[1], q_c[1]),
Q3 = c(q_v[3], q_c[3]),
Min = c(min(V), min(C)),
Max = c(max(V), max(C))
)
stats_table
perm_test_paired_sign_flip <- function(D, R = 10000, alternative = c("two.sided", "greater", "less")) {
observed_mean_diff <- mean(D)
n <- length(D)
alternative <- match.arg(alternative)
mean_diff_perm <- replicate(R, {
random_signs <- sample(c(-1, 1), size = n, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_val <- switch(alternative,
"two.sided" = mean(abs(mean_diff_perm) >= abs(observed_mean_diff)),
"greater"   = mean(mean_diff_perm > observed_mean_diff),
"less"      = mean(mean_diff_perm < observed_mean_diff)
)
return(list(
observed_mean_diff = observed_mean_diff,
p_val = p_val,
alternative = alternative
))
}
perm_test_paired_sign_flip <- function(D, R = 10000, alternative = c("two.sided", "greater", "less")) {
observed_mean_diff <- mean(D)
n <- length(D)
alternative <- match.arg(alternative)
mean_diff_perm <- replicate(R, {
random_signs <- sample(c(-1, 1), size = n, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_val <- switch(alternative,
"two.sided" = mean(abs(mean_diff_perm) >= abs(observed_mean_diff)),
"greater"   = mean(mean_diff_perm > observed_mean_diff),
"less"      = mean(mean_diff_perm < observed_mean_diff)
)
return(list(
observed_mean_diff = observed_mean_diff,
p_val = p_val,
alternative = alternative
))
}
ket_qua_kiem_dinh <- perm_test_paired_sign_flip(D, alternative = "greater", R = 10000)
ket_qua_kiem_dinh
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42) # Để đảm bảo tính lặp lại của kết quả
# Mô phỏng Hoán vị (Sign Flipping)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
# Tính p-value (một phía: P(permuted mean >= observed mean))
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
cat(paste("Trung bình chênh lệch quan sát (d_obs):", round(observed_mean_diff, 4), "\n"))
cat(paste("P-value (H_a: Chocolate > Vanilla):", p_value, "\n"))
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
round(observed_mean_diff)
p_value
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
cat(paste("Trung bình chênh lệch quan sát (d_obs):", round(observed_mean_diff, 4), "\n"))
cat(paste("P-value (H_a: Chocolate > Vanilla):", p_value, "\n"))
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
round(observed_mean_diff, 4)
p_value
perm_test_paired_sign_flip <- function(D, R = 10000, alternative = c("two.sided", "greater", "less")) {
observed_mean_diff <- mean(D)
n <- length(D)
alternative <- match.arg(alternative)
# Tạo phân phối hoán vị (Sign Flipping)
mean_diff_perm <- replicate(R, {
random_signs <- sample(c(-1, 1), size = n, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
# Tính p-value dựa trên hướng giả thuyết
p_val <- switch(alternative,
"two.sided" = mean(abs(mean_diff_perm) >= abs(observed_mean_diff)),
# CÔNG THỨC CHO H_A: GREATER (P(permuted >= observed))
"greater"   = mean(mean_diff_perm >= observed_mean_diff),
"less"      = mean(mean_diff_perm <= observed_mean_diff)
)
return(list(
observed_mean_diff = observed_mean_diff,
p_val = p_val,
alternative = alternative
))
}
# ---------------------------------------------------------
# THỰC THI KIỂM ĐỊNH MỘT PHÍA (H_a: mu_D > 0)
# ---------------------------------------------------------
ket_qua_kiem_dinh <- perm_test_paired_sign_flip(D, alternative = "greater", R = 10000)
cat("\n--- KẾT QUẢ KIỂM ĐỊNH HOÁN VỊ MỘT PHÍA ---\n")
cat(paste("Trung bình chênh lệch quan sát (d_obs):", round(ket_qua_kiem_dinh$observed_mean_diff, 4), "\n"))
cat(paste("Giả thuyết đối (Ha):", ket_qua_kiem_dinh$alternative, " (mu_D > 0)\n"))
cat(paste("P-value:", ket_qua_kiem_dinh$p_val, "\n"))
if (ket_qua_kiem_dinh$p_val < 0.05) {
cat("\nKết luận: Bác bỏ H0. Có bằng chứng mạnh mẽ rằng kem chocolate có trung bình calo cao hơn.\n")
} else {
cat("\nKết luận: Không thể bác bỏ H0.\n")
}
perm_test_paired_sign_flip <- function(D, R = 10000, alternative = c("two.sided", "greater", "less")) {
observed_mean_diff <- mean(D)
n <- length(D)
alternative <- match.arg(alternative)
mean_diff_perm <- replicate(R, {
random_signs <- sample(c(-1, 1), size = n, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_val <- switch(alternative,
"two.sided" = mean(abs(mean_diff_perm) >= abs(observed_mean_diff)),
"greater"   = mean(mean_diff_perm > observed_mean_diff),
"less"      = mean(mean_diff_perm < observed_mean_diff)
)
return(list(
observed_mean_diff = observed_mean_diff,
p_val = p_val,
alternative = alternative
))
}
ket_qua_kiem_dinh <- perm_test_paired_sign_flip(D, alternative = "greater", R = 10000)
round(ket_qua_kiem_dinh$observed_mean_diff, 4)
ket_qua_kiem_dinh$alternative
ket_qua_kiem_dinh$p_val
perm_test_paired_sign_flip <- function(D, R = 10000, alternative = c("two.sided", "greater", "less")) {
observed_mean_diff <- mean(D)
n <- length(D)
alternative <- match.arg(alternative)
mean_diff_perm <- replicate(R, {
random_signs <- sample(c(-1, 1), size = n, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_val <- switch(alternative,
"two.sided" = mean(abs(mean_diff_perm) >= abs(observed_mean_diff)),
"greater"   = mean(mean_diff_perm > observed_mean_diff),
"less"      = mean(mean_diff_perm < observed_mean_diff)
)
return(list(
observed_mean_diff = observed_mean_diff,
p_val = p_val,
alternative = alternative
))
}
ket_qua_kiem_dinh <- perm_test_paired_sign_flip(D, alternative = "greater", R = 10000)
round(ket_qua_kiem_dinh$observed_mean_diff, 4)
ket_qua_kiem_dinh$p_val
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
round(observed_mean_diff, 4)
p_value
# Code tay theo cong thuc
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
round(observed_mean_diff, 4)
p_value
# Code tay theo cong thuc
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
observed_mean_diff
round(observed_mean_diff, 4)
p_value
# Code tay theo cong thuc
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
round(observed_mean_diff, 4)
p_value
# C1: Code tay theo cong thuc
observed_mean_diff <- mean(D)
N_permutations <- 10000
set.seed(42)
permutation_means <- replicate(N_permutations, {
random_signs <- sample(c(-1, 1), size = n_obs, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_value <- sum(permutation_means >= observed_mean_diff) / N_permutations
round(observed_mean_diff, 4)
p_value
# C2: Theo hàm permutation
perm_test_paired_sign_flip <- function(D, R = 10000, alternative = c("two.sided", "greater", "less")) {
observed_mean_diff <- mean(D)
n <- length(D)
alternative <- match.arg(alternative)
mean_diff_perm <- replicate(R, {
random_signs <- sample(c(-1, 1), size = n, replace = TRUE)
permuted_diffs <- D * random_signs
mean(permuted_diffs)
})
p_val <- switch(alternative,
"two.sided" = mean(abs(mean_diff_perm) >= abs(observed_mean_diff)),
"greater"   = mean(mean_diff_perm > observed_mean_diff),
"less"      = mean(mean_diff_perm < observed_mean_diff)
)
return(list(
observed_mean_diff = observed_mean_diff,
p_val = p_val,
alternative = alternative
))
}
ket_qua_kiem_dinh <- perm_test_paired_sign_flip(D, alternative = "greater", R = 10000)
round(ket_qua_kiem_dinh$observed_mean_diff, 4)
ket_qua_kiem_dinh$p_val
>>>>>>> a14343c (Khởi tạo lại repo sạch)
