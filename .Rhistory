}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((conv_sm^2)/n_m + (conv_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
m_stats <- data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
group_by(time) |>
summarise(across(
roi,
list(
mean = mean,
median = median,
sd = sd,
min = min,
max = max
),
na.rm = TRUE,
.names = "{.fn}"
))
data_b <- data_b|>
mutate(roi = value/cost)
m_stats <- data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
group_by(time) |>
summarise(across(
roi,
list(
mean = mean,
median = median,
sd = sd,
min = min,
max = max
),
na.rm = TRUE,
.names = "{.fn}"
))
m_stats
data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
ggplot(aes(x = time, y = roi, fill = time)) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.15, color = "black", alpha = 0.8) +
scale_fill_manual(values = c("pre" = "#8C6BB1", "post" = "#9E9AC8")) +
labs(
title = "Comparison of conv Distributions (Pre vs Post)",
x = "",
y = "conv"
) +
theme_minimal(base_size = 14)
data_b |>
filter(platform == "m", time %in% c("pre", "post")) |>
mutate(roi_log = log1p(roi)) |>
ggplot(aes(x = time, y = roi_log, fill = time)) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.15, color = "black", alpha = 0.8) +
scale_fill_manual(values = c("pre" = "#8C6BB1", "post" = "#9E9AC8")) +
labs(
title = "Violin Plot using log1p(conv)",
x = "",
y = "log1p(conv)"
) +
theme_minimal(base_size = 14)
set.seed(42)
roi_m <- data_b |>
filter(platform == "m") |>
select(roi) |>
pull()
roi_d <- data_b |>
filter(platform == "d") |>
select(roi) |>
pull()
observed_diff <- abs(mean(roi_m,na.rm = TRUE) - mean(roi_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
set.seed(42)
roi_m <- data_b |>
filter(platform == "m") |>
select(roi) |>
pull()
roi_d <- data_b |>
filter(platform == "d") |>
select(roi) |>
pull()
observed_diff <- abs(mean(roi_m,na.rm = TRUE) - mean(roi_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
p_value
set.seed(42)
roi_m <- data_b |>
filter(platform == "m") |>
select(roi) |>
pull()
roi_d <- data_b |>
filter(platform == "d") |>
select(roi) |>
pull()
observed_diff <- abs(mean(roi_m,na.rm = TRUE) - mean(roi_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
p_value
diffs_simulated
n_m
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d ))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sqrt((sd(sample_m)**2)/n_m + (sd(sample_d)**2)/n_d ))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sqrt((sd(sample_m)*sd(sample_m))/n_m + (sd(sample_d)*sd(sample_d))/n_d ))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sd(sample_m))
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sample_m)
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m)
roi_d_til <- roi_d -mean(roi_d)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sample_m)
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
roi_m
roi_m_til
mean(roi_m)
clas(roi_m)
class(roi_m)
mean(roi_m)
mean(roi_m,na.rm = TRUE)
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
print(sample_m)
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
diffs_simulated
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 1
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m)
roi_sd <- sd(roi_d)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
print(sample_m)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m) - mean(sample_d))/sqrt((sd(sample_m)^2)/n_m + (sd(sample_d)^2)/n_d )
}
cat("Done.\n\n")
n_m <- length(roi_m)
n_d <- length(roi_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
roi_sm <- sd(roi_m,na.rm = TRUE)
roi_sd <- sd(roi_d,na.rm = TRUE)
roi_m_til <- roi_m - mean(roi_m,na.rm = TRUE)
roi_d_til <- roi_d -mean(roi_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(roi_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(roi_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m,na.rm = TRUE) - mean(sample_d,na.rm = TRUE))/sqrt((sd(sample_m,na.rm = TRUE)^2)/n_m + (sd(sample_d,na.rm = TRUE)^2)/n_d )
}
cat("Done.\n\n")
diffs_simulated
T_obs <- observed_diff/sqrt((roi_sm^2)/n_m + (roi_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
set.seed(42)
conv_m <- data_b |>
filter(platform == "m") |>
select(conv) |>
pull()
conv_d <- data_b |>
filter(platform == "d") |>
select(conv) |>
pull()
observed_diff <- abs(mean(conv_m,na.rm = TRUE) - mean(conv_d,na.rm = TRUE))
cat(sprintf("Sự khác biệt Quan sát (B - A): %.4f\n\n", observed_diff))
n_m <- length(conv_m)
n_d <- length(conv_d)
N_total <- n_m + n_d
num_bootstraps <- 10000
diffs_simulated <- numeric(num_bootstraps)
cat(sprintf("Boostraping (%d times)...\n", num_bootstraps))
conv_m_til <- conv_m - mean(conv_m,na.rm = TRUE)
conv_d_til <- conv_d -mean(conv_d,na.rm = TRUE)
conv_sm <- sd(conv_m,na.rm = TRUE)
conv_sd <- sd(conv_d,na.rm = TRUE)
for (i in 1:num_bootstraps) {
sample_m <- sample(conv_m_til,
size = n_m,
replace = TRUE)
sample_d <- sample(conv_d_til,
size = n_d,
replace = TRUE)
# Tính và lưu lại sự khác biệt của mẫu mô phỏng
diffs_simulated[i] <- (mean(sample_m,na.rm = TRUE) - mean(sample_d,na.rm = TRUE))/sqrt((sd(sample_m,na.rm = TRUE)^2)/n_m + (sd(sample_d,na.rm = TRUE)^2)/n_d )
}
cat("Done.\n\n")
abs(T_obs)
max(abs(diffs_simulated))
T_obs <- observed_diff/sqrt((conv_sm^2)/n_m + (conv_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
abs(T_obs)
max(abs(diffs_simulated))
T_obs <- observed_diff/sqrt((conv_sm^2)/n_m + (conv_sd^2)/n_d )
p_value <- sum(abs(diffs_simulated) >= abs(T_obs)) / num_bootstraps
# In kết quả
cat("--- Kết quả Kiểm tra Bootstrap Shift Method ---\n")
cat(sprintf("Observed Statistic (Y_bar1 - Y_bar2): %.4f\n", T_obs))
cat(sprintf("Bootstrap P-Value (Hai phía): %.4f\n", p_value))
# Kiểm tra P-Value
if (p_value < 0.05) {
cat("\nKết luận: P-value < 0.05. Bác bỏ H0. Có sự khác biệt có ý nghĩa thống kê giữa mu1 và mu2.\n")
} else {
cat("\nKết luận: P-value >= 0.05. Không bác bỏ H0. Không có đủ bằng chứng về sự khác biệt.\n")
}
cpc_m_zero <- data_b |>
filter(time == "post", cpc == 0, platform == "m")
cpc_m <- data_b |>
filter(time == "post", platform == "m")
cpc_d_zero <- data_b |>
filter(time == "post", cpc == 0, platform == "d")
cpc_d <- data_b |>
filter(time == "post", platform == "d")
cpc_m_zero
prop.test(
x = c(nrow(cpc_m_zero), nrow(cpc_d_zero)),
n = c(nrow(cpc_m), nrow(cpc_d)),
correct = FALSE
)
